import { autenticacionPin } from "./autenticacion/autenticacion.js";
import { deposito } from "./operaciones/deposito.js";
import { leerTarjeta } from "./tarjeta/leerTarjeta.js";
import rl from "readline-sync";

console.log(
  `  
        ██████╗░░█████╗░███╗░░██╗░█████╗░░█████╗░   ██████╗░██████╗░░█████╗░
        ██╔══██╗██╔══██╗████╗░██║██╔══██╗██╔══██╗   ██╔══██╗██╔══██╗██╔══██╗
        ██████╦╝███████║██╔██╗██║██║░░╚═╝██║░░██║   ██████╔╝██║░░██║███████║
        ██╔══██╗██╔══██║██║╚████║██║░░██╗██║░░██║   ██╔═══╝░██║░░██║██╔══██║
        ██████╦╝██║░░██║██║░╚███║╚█████╔╝╚█████╔╝   ██║░░░░░██████╔╝██║░░██║
        ╚═════╝░╚═╝░░╚═╝╚═╝░░╚══╝░╚════╝░░╚════╝░   ╚═╝░░░░░╚═════╝░╚═╝░░╚═╝

                            ¡Bienvenido al Banco PDA!
`
);

console.log(
  "══════════════════════════════════════════════════════════════════════════════════════"
);

const ubicacion = rl.questionPath("- Ingrese su tarjeta: ");

const tarjetaUsuario = await leerTarjeta(ubicacion);

console.log(
  `
                        ╔═════════════════════════════╗
                        ║   ✅ Lectura Exitosa! ✅    ║
                        ╚═════════════════════════════╝
 `
);

console.log(
  "══════════════════════════════════════════════════════════════════════════════════════"
);

console.log(
  `                                             
                   ╔══════════════════════════════════════════╗                     
                   ║                                          ║
                   ║        Ａｕｔｅｎｔｉｃａｃｉｏｎ        ║   
                   ║                                          ║   
                   ║                    🛡                     ║   
                   ╚══════════════════════════════════════════╝   
`
);

const pinUsuario = rl.question("- Ingrese su PIN: ", { hideEchoBack: true });

const autenticacion = await autenticacionPin(
  tarjetaUsuario.idTarjeta,
  pinUsuario
);

if (autenticacion) {
  console.log(
    "══════════════════════════════════════════════════════════════════════════════════════"
  );

  console.log(
    `
      ╔═══════════════════════════════════════════════════════════╗
      ║                          ＭＥＮＵ                         ║
      ║   ╔══════════════════╗         ╔═══════════════════════╗  ║
      ║   ║  💸 1. Depositar ║         ║ 💰 3. Consultar Saldo ║  ║ 
      ║   ╚══════════════════╝         ╚═══════════════════════╝  ║ 
      ║                                                           ║ 
      ║   ╔═══════════════════╗        ╔═══════════════════════╗  ║ 
      ║   ║ 🔍 2. Retiro      ║        ║ 🔄 4. Transacciones   ║  ║ 
      ║   ╚═══════════════════╝        ╚═══════════════════════╝  ║ 
      ║                                                           ║
      ╚═══════════════════════════════════════════════════════════╝
      `
  );

  const opcionOperacion = rl.questionInt("-Escoja una opcion: ");

  switch (opcionOperacion) {
    case 1:
      console.log(
        `
          ╔═════════════════════════════════════════╗
          ║                Ｍｏｎｔｏ               ║ 
          ╚═════════════════════════════════════════╝                          
          ║   ╔═══════════╗         ╔═══════════╗   ║
          ║   ║  💸 20    ║         ║ 💸 80     ║   ║ 
          ║   ╚═══════════╝         ╚═══════════╝   ║ 
          ║                                         ║ 
          ║   ╔═══════════╗         ╔═══════════╗   ║ 
          ║   ║ 💸 40     ║         ║💸 100     ║   ║ 
          ║   ╚═══════════╝         ╚═══════════╝   ║ 
          ║                                         ║
          ╚═════════════════════════════════════════╝
          `
      );

      const montoDeposito = rl.questionInt('-Ingrese un monto: ');

      deposito(montoDeposito,tarjetaUsuario.idTarjeta);

      break;

    case 2:
      console.log(
        `
          ╔═════════════════════════════════════════╗
          ║                Ｍｏｎｔｏ               ║ 
          ╚═════════════════════════════════════════╝                          
          ║   ╔═══════════╗         ╔═══════════╗   ║
          ║   ║  💸 20    ║         ║ 💸 80     ║   ║ 
          ║   ╚═══════════╝         ╚═══════════╝   ║ 
          ║                                         ║ 
          ║   ╔═══════════╗         ╔═══════════╗   ║ 
          ║   ║ 💸 40     ║         ║💸 100     ║   ║ 
          ║   ╚═══════════╝         ╚═══════════╝   ║ 
          ║                                         ║
          ╚═════════════════════════════════════════╝
          `
      );

      break;

    case 3:
      console.log(
        `
          ╔═══════════════════════════════════╗
          ║    Ｃｏｎｓｕｌｔａ  Ｓａｌｄｏ   ║
          ║                                   ║
          ║               🔍                  ║
          ╚═══════════════════════════════════╝
          `
      );

      break;

    case 4:
      console.log(
        `
          ╔═══════════════════════════════════════════╗
          ║    Ｃｏｎｓｕｌｔａ Ｈｉｓｔｏｒｉａｌ    ║
          ║                                           ║
          ║                   🕒                      ║
          ╚═══════════════════════════════════════════╝
          `
      );

      break;

    default:
      break;
  }
} else {
  console.log(
    `
                ╔═════════════════════════╗
                ║           ⚠️             ║
                ║                         ║
                ║     Pin incorrecto      ║
                ╚═════════════════════════╝
    `
  );
  process.exit(0);
}
